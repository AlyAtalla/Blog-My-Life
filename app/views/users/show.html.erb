<div class="row mb-4">
  <div class="col-md-3 text-center">
    <% if @user.avatar_url.present? %>
      <%= image_tag @user.avatar_url, alt: @user.name, class: 'rounded-circle', style: 'width:140px;height:140px;object-fit:cover;' %>
    <% else %>
      <%= image_tag 'https://placehold.co/140x140/png?text=Avatar', alt: @user.name, class: 'rounded-circle', style: 'width:140px;height:140px;object-fit:cover;' %>
    <% end %>
  </div>
  <div class="col-md-9">
    <h2><%= @user.name %></h2>
    <p class="text-muted"><%= @user.email %></p>
    <% if @user.bio.present? %>
      <p><%= simple_format(@user.bio) %></p>
    <% end %>

    <div class="d-flex gap-2">
      <% if current_user == @user %>
        <%= link_to 'Edit Profile', profile_path, class: 'btn btn-primary' %>
        <%= link_to 'My Posts', posts_path(user_id: @user.id), class: 'btn btn-outline-secondary' %>
      <% else %>
        <%= link_to 'View posts', posts_path(user_id: @user.id), class: 'btn btn-outline-primary' %>
        <% if logged_in? %>
          <%= link_to 'Message', new_message_path(recipient_id: @user.id), class: 'btn btn-primary' %>
        <% end %>
      <% end %>
    </div>
  </div>
</div>

<div class="mb-4">
  <h4>Recent posts</h4>
  <div class="row">
    <% @user.posts.order(created_at: :desc).limit(6).each do |post| %>
      <div class="col-md-6 mb-3">
        <div class="card h-100">
          <% if post.image_url.present? %>
            <%= link_to post_path(post) do %>
              <%= image_tag post.image_url, class: 'card-img-top', alt: post.title, style: 'height:140px;object-fit:cover;' %>
            <% end %>
          <% end %>
          <div class="card-body">
            <h5 class="card-title"><%= link_to post.title, post %></h5>
            <p class="card-text"><%= truncate(post.body, length: 120) %></p>
          </div>
        </div>
      </div>
    <% end %>
  </div>
</div>
